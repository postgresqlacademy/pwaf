--
DELETE FROM pwaf_app_dba.http_request_routes WHERE path = '/pwaf_app_dba/dashboard';
INSERT INTO pwaf_app_dba.http_request_routes (path,controller,require_valid_user) VALUES ('/pwaf_app_dba/dashboard','pwaf_app_dba.pub_controller_dashboard', True);

DELETE FROM pwaf_app_dba.http_request_routes WHERE path = '/pwaf_app_dba';
INSERT INTO pwaf_app_dba.http_request_routes (path,controller,require_valid_user) VALUES ('/pwaf_app_dba','pwaf_app_dba.pub_controller_root',True);
--
TRUNCATE pwaf_app_dba.gui_templates CASCADE;
COPY pwaf_app_dba.gui_templates (id, description, xslt_stylesheet, code) FROM stdin;
60001	PWAF App DBA Layout	<xsl:stylesheet version="1.0"\r\n    xmlns:xsl="http://www.w3.org/1999/XSL/Transform"\r\n    xmlns:xsd="http://www.w3.org/2001/XMLSchema"\r\n    xmlns="http://www.w3.org/1999/xhtml"\r\n>\r\n\r\n<xsl:output method="xml"\r\n      doctype-system="http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"\r\n      doctype-public="-//W3C/DTD XHTML 1.0 Strict//EN"\r\n      indent="yes"\r\n     />\r\n\r\n<xsl:template match="/*">\r\n    <xsl:variable name="schema" select="//xsd:schema"/>\r\n    <xsl:variable name="tabletypename"\r\n                  select="$schema/xsd:element[@name=name(current())]/@type"/>\r\n    <xsl:variable name="rowtypename"\r\n                  select="$schema/xsd:complexType[@name=$tabletypename]/xsd:sequence/xsd:element[@name='row']/@type"/>\r\n\r\n<html>\r\n\r\n<head>\r\n    <title>${title}</title>\r\n    <meta charset="utf-8" />\r\n    <meta name="viewport" content="width=device-width, initial-scale=1" />\r\n    <link rel="stylesheet" href="/asset/pwaf_app_dba/style.css" />\r\n    <link rel="stylesheet" type="text/css" href="http://cdn.sencha.io/ext-4.0.7-gpl/resources/css/ext-all.css" />\r\n    <script src="http://cdn.sencha.io/ext-4.0.7-gpl/ext-all-debug.js" type="text/javascript" charset="utf-8"></script>\r\n</head>\r\n\r\n<body>\r\n\r\n<section id="wrap">\r\n\r\n    <header></header>\r\n\r\n        <section id="content">\r\n\r\n            <div class="overview">\r\n                <ul>\r\n                    <li><a target="_blank" href="/pwaf_app_dba/disk_usage">Disk Space Usage</a></li>\r\n                    <li><a target="_blank" href="/pwaf_app_dba/activity">Activity</a></li>\r\n                    <li><a target="_blank" href="/pwaf_app_dba/configuration">Server Configuration</a></li>\r\n                </ul>\r\n                <xsl:value-of select="row[2]/." disable-output-escaping="yes" />\r\n            </div>\r\n\r\n            <div class="main-content"><xsl:value-of select="row[1]/." disable-output-escaping="yes" /></div>\r\n\r\n        </section>\r\n\r\n        <div class="clear"></div>\r\n\r\n    <footer>\r\n        <div id="footer-content">\r\n            (c) 2013 postgresqlacademy.com and other contributors\r\n        </div>\r\n    </footer>\r\n\r\n\r\n    \r\n    \r\n    <div><xsl:value-of select="row[3]/." disable-output-escaping="yes" /></div>\r\n    <div><xsl:value-of select="row[4]/." disable-output-escaping="yes" /></div>\r\n   \r\n</section>\r\n\r\n</body>\r\n</html>\r\n</xsl:template>\r\n\r\n</xsl:stylesheet>	pwaf_app_dba_main_layout
60004	PWAF App DBA - Dashboard View	<xsl:stylesheet version="1.0"\r\n    xmlns:xsl="http://www.w3.org/1999/XSL/Transform"\r\n    xmlns:xsd="http://www.w3.org/2001/XMLSchema"\r\n    xmlns="http://www.w3.org/1999/xhtml"\r\n>\r\n\r\n<xsl:output method="xml" omit-xml-declaration="yes" indent="yes" />\r\n\r\n  <xsl:template match="/*">\r\n    <h1>PWAF DBA Dashboard</h1>\r\n     \r\n    <script>\r\n    <![CDATA[\r\n\r\nExt.onReady(function() {\r\n\r\n    Ext.require('*');\r\n\r\n    Ext.QuickTips.init();\r\n\r\n    var downloadChart = function(chart){\r\n        Ext.MessageBox.confirm('Confirm Download', 'Would you like to download the chart as an image?', function(choice){\r\n            if(choice == 'yes'){\r\n                chart.save({\r\n                    type: 'image/png'\r\n                });\r\n            }\r\n        });\r\n    };\r\n\r\n    Ext.define('ServiceList_model1', {\r\n        extend: 'Ext.data.Model',\r\n        fields: [\r\n            {name:'relid', type:'int'},\r\n            {name:'objectname', type:'string'},\r\n            {name:'seq_scan', type:'int'},\r\n            {name:'idx_scan', type:'int'}\r\n\r\n        ]\r\n    });\r\n\r\n    var store1 = Ext.create('Ext.data.JsonStore', {\r\n        model: 'ServiceList_model1',\r\n        autoLoad: true,\r\n        proxy: {\r\n            limitParam: undefined,\r\n            startParam: undefined,\r\n            paramName: undefined,\r\n            pageParam: undefined,\r\n            noCache:false,\r\n            type: 'ajax',\r\n            url: '/pwaf_app_dba/dashboard/data.json',\r\n            reader: {\r\n\t        type: 'json',\r\n                root: 'data'\r\n            }\r\n        }\r\n    });\r\n\r\n    var chart1 = Ext.create('Ext.chart.Chart',{\r\n           xtype: 'chart',\r\n            animate: false,\r\n            store: store1,\r\n            insetPadding: 30,\r\n            axes: [{\r\n                type: 'Numeric',\r\n                minimum: 0,\r\n                position: 'left',\r\n                fields: ['seq_scan','idx_scan'],\r\n                title: false,\r\n                grid: true,\r\n                label: {\r\n                    font: '10px Arial'\r\n                }\r\n            }, {\r\n                type: 'Category',\r\n                position: 'bottom',\r\n                fields: ['objectname'],\r\n                title: false,\r\n                label: {\r\n                    font: '11px Arial'\r\n                }\r\n            }],\r\n            series: [{\r\n                type: 'line',\r\n                axis: 'left',\r\n                xField: ['objectname'],\r\n                yField: ['seq_scan'],\r\n                tips: {\r\n                    trackMouse: true,\r\n                    width: 250,\r\n                    height: 40,\r\n                    renderer: function(storeItem, item) {\r\n                        this.setTitle(storeItem.get('objectname'));\r\n                        this.update('seq_scan: '+storeItem.get('seq_scan'));\r\n                    }\r\n                },\r\n                style: {\r\n                    fill: '#38B8BF',\r\n                    stroke: '#38B8BF',\r\n                    'stroke-width': 3\r\n                },\r\n                markerConfig: {\r\n                    type: 'circle',\r\n                    size: 4,\r\n                    radius: 4,\r\n                    'stroke-width': 1,\r\n                    fill: '#38B8BF',\r\n                    stroke: '#38B8BF'\r\n                }\r\n            },{\r\n                type: 'line',\r\n                axis: 'left',\r\n                xField: ['objectname'],\r\n                yField: ['idx_scan'],\r\n                tips: {\r\n                    trackMouse: true,\r\n                    width: 250,\r\n                    height: 50,\r\n                    renderer: function(storeItem, item) {\r\n                        this.setTitle(storeItem.get('objectname'));\r\n                        this.update('idx_scan: '+storeItem.get('idx_scan'));\r\n                    }\r\n                },\r\n                style: {\r\n                    fill: '#18989F',\r\n                    stroke: '#18989F',\r\n                    'stroke-width': 3\r\n                },\r\n                markerConfig: {\r\n                    type: 'circle',\r\n                    size: 4,\r\n                    radius: 4,\r\n                    'stroke-width': 1,\r\n                    fill: '#38B8BF',\r\n                    stroke: '#38B8BF'\r\n                }\r\n                \r\n            }] \r\n        });\r\n \r\n\r\n    var panel1 = Ext.create('widget.panel', {\r\n        width: 600,\r\n        height: 300,\r\n        title: 'Server database load',\r\n        renderTo: 'chartas',\r\n        layout: 'fit',\r\n        items: chart1,\r\n        tbar: [{\r\n            text: 'Save Chart',\r\n            handler: function(){ downloadChart(chart1); }\r\n        }]\r\n    });\r\n\r\n  \r\n    });\r\n\r\n\r\n    ]]>\r\n    </script>\r\n\r\n    <div id="chartas" />\r\n\r\n  </xsl:template>\r\n\r\n</xsl:stylesheet>	pwaf_app_dba_dashboard
\.
--
TRUNCATE pwaf_app_dba.gui_layouts CASCADE;
COPY pwaf_app_dba.gui_layouts (id, template, code) FROM stdin;
60002	60001	pwaf_app_dba_main_layout
\.
--
TRUNCATE pwaf_app_dba.gui_views CASCADE;
COPY pwaf_app_dba.gui_views (id, template, layout, code) FROM stdin;
60003	60004	60002	pwaf_app_dba_main
\.
--

TRUNCATE pwaf_app_dba.assets CASCADE;
COPY pwaf_app_dba.assets (id, content_type, data, name) FROM stdin;
60005	text/css	@charset "utf-8";\r\n/* CSS Document */\r\n\r\n/* http://meyerweb.com/eric/tools/css/reset/ \r\n   v2.0 | 20110126\r\n   License: none (public domain)\r\n*/\r\n\r\nhtml, body, div, span, applet, object, iframe,\r\nh1, h2, h3, h4, h5, h6, p, blockquote, pre,\r\na, abbr, acronym, address, big, cite, code,\r\ndel, dfn, em, img, ins, kbd, q, s, samp,\r\nsmall, strike, strong, sub, sup, tt, var,\r\nb, u, i, center,\r\ndl, dt, dd, ol, ul, li,\r\nfieldset, form, label, legend,\r\ntable, caption, tbody, tfoot, thead, tr, th, td,\r\narticle, aside, canvas, details, embed, \r\nfigure, figcaption, footer, header, hgroup, \r\nmenu, nav, output, ruby, section, summary,\r\ntime, mark, audio, video {\r\n\tmargin: 0;\r\n\tpadding: 0;\r\n\tborder: 0;\r\n\tfont-size: 100%;\r\n\tfont: inherit;\r\n\tvertical-align: baseline;\r\n}\r\n/* HTML5 display-role reset for older browsers */\r\narticle, aside, details, figcaption, figure, \r\nfooter, header, hgroup, menu, nav, section {\r\n\tdisplay: block;\r\n}\r\nbody {\r\n\tline-height: 1;\r\n    min-width: 1000px;\r\n}\r\nol, ul {\r\n\tlist-style: none;\r\n}\r\nblockquote, q {\r\n\tquotes: none;\r\n}\r\nblockquote:before, blockquote:after,\r\nq:before, q:after {\r\n\tcontent: '';\r\n\tcontent: none;\r\n}\r\ntable {\r\n\tborder-collapse: collapse;\r\n\tborder-spacing: 0;\r\n}\r\n\r\nh1, h2, h3, h4, h5, h6{\r\n\tcursor: default;\r\n}\r\n\r\n\r\n/*reset ends*/\r\n\r\nbody{\r\n    background-color: #F0F0F0;\r\n    font-family: Arial, sans-serif;\r\n}\r\n\r\nheader{\r\n    width:100%;\r\n    height:50px;\r\n}\r\n\r\nsection#content{\r\n    width: 960px;\r\n    margin: 0 auto;\r\n    padding: 25px 0 20px 0;\r\n}\r\n\r\nfooter{\r\n    background:#3B3C3A;\r\n    margin-top:25px;\r\n}\r\n\r\n#footer-content{\r\n    width:960px;\r\n    margin: 0 auto;\r\n    font-size:0.75em;\r\n    color:#fff;\r\n    padding:25px;\r\n}\r\n\r\n.overview {\r\n    width: 220px;\r\n    float: left;\r\n    min-height: 100px;\r\n    margin-right: 16px;\r\n    padding-top:25px;\r\n}\r\n\r\n.main-content{\r\n    width: 654px;\r\n    float: left;\r\n    background-color: white;\r\n    min-height: 500px;\r\n    border-radius: 6px;\r\n    box-shadow: 0 0 7px #DADADA;\r\n    padding: 33px;\r\n}\r\n\r\n.main-content h1 {\r\n    color: #39444A;\r\n    font-size: 36px;\r\n    margin-bottom: 8px;\r\n}\r\n\r\n.clear{\r\n\tclear:both;\r\n\twidth:100%;\r\n}\r\n\r\n.overview ul li a {\r\n    text-decoration: none;\r\n    color: #686868;\r\n    line-height: 40px;\r\n    width: 100%;\r\n    display: block;\r\n    border-bottom:1px solid #d4d4d4;\r\n}	style.css
\.

